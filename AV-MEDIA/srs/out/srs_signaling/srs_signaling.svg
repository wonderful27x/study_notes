<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1612px" preserveAspectRatio="none" style="width:918px;height:1612px;background:#FFFFFF;" version="1.1" viewBox="0 0 918 1612" width="918px" zoomAndPan="magnify"><defs><filter height="300%" id="fqc15h4jettmy" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="154" x="384.5" y="32.8799">SRS signaling UML</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="239" x2="239" y1="84.3357" y2="1564.9444"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="449" x2="449" y1="84.3357" y2="1564.9444"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="537" x2="537" y1="84.3357" y2="1564.9444"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="709" x2="709" y1="84.3357" y2="1564.9444"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="805" x2="805" y1="84.3357" y2="1564.9444"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="873" x2="873" y1="84.3357" y2="1564.9444"/><rect fill="#FEFECE" filter="url(#fqc15h4jettmy)" height="34.2719" style="stroke:#A80036;stroke-width:1.5;" width="107" x="184" y="45.0638"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="191" y="68.3038">one2one.html</text><rect fill="#FEFECE" filter="url(#fqc15h4jettmy)" height="34.2719" style="stroke:#A80036;stroke-width:1.5;" width="107" x="184" y="1563.9444"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="191" y="1587.1844">one2one.html</text><rect fill="#FEFECE" filter="url(#fqc15h4jettmy)" height="34.2719" style="stroke:#A80036;stroke-width:1.5;" width="71" x="412" y="45.0638"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="419" y="68.3038">srs.sig.js</text><rect fill="#FEFECE" filter="url(#fqc15h4jettmy)" height="34.2719" style="stroke:#A80036;stroke-width:1.5;" width="71" x="412" y="1563.9444"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="419" y="1587.1844">srs.sig.js</text><rect fill="#FEFECE" filter="url(#fqc15h4jettmy)" height="34.2719" style="stroke:#A80036;stroke-width:1.5;" width="76" x="497" y="45.0638"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="504" y="68.3038">srs.sdk.js</text><rect fill="#FEFECE" filter="url(#fqc15h4jettmy)" height="34.2719" style="stroke:#A80036;stroke-width:1.5;" width="76" x="497" y="1563.9444"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="504" y="1587.1844">srs.sdk.js</text><rect fill="#FEFECE" filter="url(#fqc15h4jettmy)" height="34.2719" style="stroke:#A80036;stroke-width:1.5;" width="90" x="662" y="45.0638"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="669" y="68.3038">httpx-static</text><rect fill="#FEFECE" filter="url(#fqc15h4jettmy)" height="34.2719" style="stroke:#A80036;stroke-width:1.5;" width="90" x="662" y="1563.9444"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="669" y="1587.1844">httpx-static</text><rect fill="#FEFECE" filter="url(#fqc15h4jettmy)" height="34.2719" style="stroke:#A80036;stroke-width:1.5;" width="75" x="766" y="45.0638"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="773" y="68.3038">signaling</text><rect fill="#FEFECE" filter="url(#fqc15h4jettmy)" height="34.2719" style="stroke:#A80036;stroke-width:1.5;" width="75" x="766" y="1563.9444"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="773" y="1587.1844">signaling</text><rect fill="#FEFECE" filter="url(#fqc15h4jettmy)" height="34.2719" style="stroke:#A80036;stroke-width:1.5;" width="33" x="855" y="45.0638"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19" x="862" y="68.3038">srs</text><rect fill="#FEFECE" filter="url(#fqc15h4jettmy)" height="34.2719" style="stroke:#A80036;stroke-width:1.5;" width="33" x="855" y="1563.9444"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19" x="862" y="1587.1844">srs</text><line style="stroke:#A80036;stroke-width:1.0;" x1="239.5" x2="281.5" y1="119.1598" y2="119.1598"/><line style="stroke:#A80036;stroke-width:1.0;" x1="281.5" x2="281.5" y1="119.1598" y2="132.1598"/><line style="stroke:#A80036;stroke-width:1.0;" x1="240.5" x2="281.5" y1="132.1598" y2="132.1598"/><polygon fill="#A80036" points="250.5,128.1598,240.5,132.1598,250.5,136.1598,246.5,132.1598" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="246.5" y="113.4158">btn_start.click(){startDemo}</text><polygon fill="#A80036" points="437.5,160.9838,447.5,164.9838,437.5,168.9838,441.5,164.9838" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="239.5" x2="443.5" y1="164.9838" y2="164.9838"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="246.5" y="159.2398">1:connect(host,room,display)</text><polygon fill="#A80036" points="793.5,193.8078,803.5,197.8078,793.5,201.8078,797.5,197.8078" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="449.5" x2="799.5" y1="197.8078" y2="197.8078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="456.5" y="192.0638">websocket.connect()</text><polygon fill="#A80036" points="460.5,226.6318,450.5,230.6318,460.5,234.6318,456.5,230.6318" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="454.5" x2="804.5" y1="230.6318" y2="230.6318"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="466.5" y="224.8878">onopen</text><polygon fill="#A80036" points="250.5,259.4558,240.5,263.4558,250.5,267.4558,246.5,263.4558" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="244.5" x2="448.5" y1="263.4558" y2="263.4558"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="256.5" y="257.7118">onopen</text><polygon fill="#A80036" points="437.5,292.2798,447.5,296.2798,437.5,300.2798,441.5,296.2798" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="239.5" x2="443.5" y1="296.2798" y2="296.2798"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="246.5" y="290.5358">2:send("join")</text><polygon fill="#A80036" points="793.5,325.1039,803.5,329.1039,793.5,333.1039,797.5,329.1039" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="449.5" x2="799.5" y1="329.1039" y2="329.1039"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="456.5" y="323.3599">websocket.send()</text><polygon fill="#A80036" points="460.5,357.9279,450.5,361.9279,460.5,365.9279,456.5,361.9279" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="454.5" x2="804.5" y1="361.9279" y2="361.9279"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="466.5" y="356.1839">participants</text><polygon fill="#A80036" points="250.5,405.1639,240.5,409.1639,250.5,413.1639,246.5,409.1639" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="244.5" x2="448.5" y1="409.1639" y2="409.1639"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="256.5" y="403.4199">participants</text><path d="M454,374.9279 L454,421.9279 L660,421.9279 L660,384.9279 L650,374.9279 L454,374.9279 " fill="#FBFB77" filter="url(#fqc15h4jettmy)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M650,374.9279 L650,384.9279 L660,384.9279 L650,374.9279 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="460" y="395.0079">return room message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="463" y="413.8319">include the ids of participants</text><line style="stroke:#A80036;stroke-width:1.0;" x1="239.5" x2="281.5" y1="456.3999" y2="456.3999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="281.5" x2="281.5" y1="456.3999" y2="469.3999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="240.5" x2="281.5" y1="469.3999" y2="469.3999"/><polygon fill="#A80036" points="250.5,465.3999,240.5,469.3999,250.5,473.3999,246.5,469.3999" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="246.5" y="450.6559">startPublish()</text><polygon fill="#A80036" points="525,498.2239,535,502.2239,525,506.2239,529,502.2239" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="239.5" x2="531" y1="502.2239" y2="502.2239"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="246.5" y="496.4799">3:publish(url)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="537" x2="579" y1="535.048" y2="535.048"/><line style="stroke:#A80036;stroke-width:1.0;" x1="579" x2="579" y1="535.048" y2="548.048"/><line style="stroke:#A80036;stroke-width:1.0;" x1="538" x2="579" y1="548.048" y2="548.048"/><polygon fill="#A80036" points="548,544.048,538,548.048,548,552.048,544,548.048" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="544" y="529.304">create local stream</text><line style="stroke:#A80036;stroke-width:1.0;" x1="537" x2="579" y1="580.872" y2="580.872"/><line style="stroke:#A80036;stroke-width:1.0;" x1="579" x2="579" y1="580.872" y2="593.872"/><line style="stroke:#A80036;stroke-width:1.0;" x1="538" x2="579" y1="593.872" y2="593.872"/><polygon fill="#A80036" points="548,589.872,538,593.872,548,597.872,544,593.872" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="544" y="575.128">createOffer()</text><line style="stroke:#A80036;stroke-width:1.0;" x1="537" x2="579" y1="626.696" y2="626.696"/><line style="stroke:#A80036;stroke-width:1.0;" x1="579" x2="579" y1="626.696" y2="639.696"/><line style="stroke:#A80036;stroke-width:1.0;" x1="538" x2="579" y1="639.696" y2="639.696"/><polygon fill="#A80036" points="548,635.696,538,639.696,548,643.696,544,639.696" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="544" y="620.952">setLocalDescription(offer)</text><polygon fill="#A80036" points="697,692.344,707,696.344,697,700.344,701,696.344" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="537" x2="703" y1="696.344" y2="696.344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="544" y="690.6">post publish/offer</text><path d="M291,652.696 L291,718.696 L528,718.696 L528,662.696 L518,652.696 L291,652.696 " fill="#FBFB77" filter="url(#fqc15h4jettmy)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M518,652.696 L518,662.696 L528,662.696 L518,652.696 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="297" y="672.776">srs server separate from signaling`s</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="300" y="691.6">use http to publish the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="300" y="710.424">stream to srs server</text><ellipse cx="873" cy="752.2421" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="856,748.9921,866,752.9921,856,756.9921,860,752.9921" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="709" x2="862" y1="752.9921" y2="752.9921"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="716" y="747.2481">publish stream to srs</text><polygon fill="#A80036" points="548,796.2281,538,800.2281,548,804.2281,544,800.2281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="542" x2="708" y1="800.2281" y2="800.2281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="554" y="794.4841">answer</text><path d="M714,765.9921 L714,812.9921 L909,812.9921 L909,775.9921 L899,765.9921 L714,765.9921 " fill="#FBFB77" filter="url(#fqc15h4jettmy)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M899,765.9921 L899,775.9921 L909,775.9921 L899,765.9921 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="720" y="786.0721">use lite-ice</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="723" y="804.8961">candidate is included in sdp</text><line style="stroke:#A80036;stroke-width:1.0;" x1="537" x2="579" y1="847.4641" y2="847.4641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="579" x2="579" y1="847.4641" y2="860.4641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="538" x2="579" y1="860.4641" y2="860.4641"/><polygon fill="#A80036" points="548,856.4641,538,860.4641,548,864.4641,544,860.4641" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="544" y="841.7201">setRemoteDescription()</text><polygon fill="#A80036" points="250.5,870.4641,240.5,874.4641,250.5,878.4641,246.5,874.4641" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="244.5" x2="536" y1="874.4641" y2="874.4641"/><polygon fill="#A80036" points="437.5,927.1121,447.5,931.1121,437.5,935.1121,441.5,931.1121" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="239.5" x2="443.5" y1="931.1121" y2="931.1121"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="246.5" y="925.3681">4:notify publish</text><path d="M8,887.4641 L8,953.4641 L230,953.4641 L230,897.4641 L220,887.4641 L8,887.4641 " fill="#FBFB77" filter="url(#fqc15h4jettmy)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M220,887.4641 L220,897.4641 L230,897.4641 L220,887.4641 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="14" y="907.5441">after publish stream to srs server</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="17" y="926.3681">refresh the signaling server</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="17" y="945.1922">tell about new strem published</text><polygon fill="#008000" points="793.5,983.7602,803.5,987.7602,793.5,991.7602,797.5,987.7602" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="449.5" x2="799.5" y1="987.7602" y2="987.7602"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="456.5" y="982.0162">websocket.send("publish")</text><polygon fill="#A80036" points="460.5,1016.5842,450.5,1020.5842,460.5,1024.5842,456.5,1020.5842" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="454.5" x2="804.5" y1="1020.5842" y2="1020.5842"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="466.5" y="1014.8402">publish ok</text><polygon fill="#A80036" points="250.5,1049.4082,240.5,1053.4082,250.5,1057.4082,246.5,1053.4082" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="244.5" x2="448.5" y1="1053.4082" y2="1053.4082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="256.5" y="1047.6642">publish ok</text><line style="stroke:#A80036;stroke-width:1.0;" x1="239.5" x2="281.5" y1="1094.1442" y2="1094.1442"/><line style="stroke:#A80036;stroke-width:1.0;" x1="281.5" x2="281.5" y1="1094.1442" y2="1107.1442"/><line style="stroke:#A80036;stroke-width:1.0;" x1="240.5" x2="281.5" y1="1107.1442" y2="1107.1442"/><polygon fill="#A80036" points="250.5,1103.1442,240.5,1107.1442,250.5,1111.1442,246.5,1107.1442" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="246.5" y="1088.4002">startPlay()</text><path d="M5,1066.4082 L5,1113.4082 L231,1113.4082 L231,1076.4082 L221,1066.4082 L5,1066.4082 " fill="#FBFB77" filter="url(#fqc15h4jettmy)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M221,1066.4082 L221,1076.4082 L231,1076.4082 L221,1066.4082 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="11" y="1086.4882">play the streams connecting with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="14" y="1105.3122">participants returned in room</text><polygon fill="#A80036" points="525,1143.8803,535,1147.8803,525,1151.8803,529,1147.8803" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="239.5" x2="531" y1="1147.8803" y2="1147.8803"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="246.5" y="1142.1363">5:for(participants.id) -&gt; play(url)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="537" x2="579" y1="1180.7043" y2="1180.7043"/><line style="stroke:#A80036;stroke-width:1.0;" x1="579" x2="579" y1="1180.7043" y2="1193.7043"/><line style="stroke:#A80036;stroke-width:1.0;" x1="538" x2="579" y1="1193.7043" y2="1193.7043"/><polygon fill="#A80036" points="548,1189.7043,538,1193.7043,548,1197.7043,544,1193.7043" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="544" y="1174.9603">createOffer()</text><line style="stroke:#A80036;stroke-width:1.0;" x1="537" x2="579" y1="1226.5283" y2="1226.5283"/><line style="stroke:#A80036;stroke-width:1.0;" x1="579" x2="579" y1="1226.5283" y2="1239.5283"/><line style="stroke:#A80036;stroke-width:1.0;" x1="538" x2="579" y1="1239.5283" y2="1239.5283"/><polygon fill="#A80036" points="548,1235.5283,538,1239.5283,548,1243.5283,544,1239.5283" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="544" y="1220.7843">setLocalDescription(offer)</text><polygon fill="#A80036" points="697,1268.3523,707,1272.3523,697,1276.3523,701,1272.3523" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="537" x2="703" y1="1272.3523" y2="1272.3523"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="544" y="1266.6083">post play/offer</text><ellipse cx="873" cy="1304.4263" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="856,1301.1763,866,1305.1763,856,1309.1763,860,1305.1763" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="709" x2="862" y1="1305.1763" y2="1305.1763"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="716" y="1299.4323">play stream from srs</text><polygon fill="#A80036" points="548,1334.0003,538,1338.0003,548,1342.0003,544,1338.0003" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="542" x2="708" y1="1338.0003" y2="1338.0003"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="554" y="1332.2563">answer</text><line style="stroke:#A80036;stroke-width:1.0;" x1="537" x2="579" y1="1370.8244" y2="1370.8244"/><line style="stroke:#A80036;stroke-width:1.0;" x1="579" x2="579" y1="1370.8244" y2="1383.8244"/><line style="stroke:#A80036;stroke-width:1.0;" x1="538" x2="579" y1="1383.8244" y2="1383.8244"/><polygon fill="#A80036" points="548,1379.8244,538,1383.8244,548,1387.8244,544,1383.8244" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="544" y="1365.0804">setRemoteDescription()</text><polygon fill="#A80036" points="250.5,1412.6484,240.5,1416.6484,250.5,1420.6484,246.5,1416.6484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="244.5" x2="536" y1="1416.6484" y2="1416.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="256.5" y="1410.9044">show</text><polygon fill="#008000" points="460.5,1445.4724,450.5,1449.4724,460.5,1453.4724,456.5,1449.4724" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="454.5" x2="804.5" y1="1449.4724" y2="1449.4724"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="466.5" y="1443.7284">message: some publish stream</text><polygon fill="#A80036" points="250.5,1478.2964,240.5,1482.2964,250.5,1486.2964,246.5,1482.2964" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="244.5" x2="448.5" y1="1482.2964" y2="1482.2964"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="256.5" y="1476.5524">message: some publish stream</text><line style="stroke:#A80036;stroke-width:1.0;" x1="239.5" x2="281.5" y1="1533.9444" y2="1533.9444"/><line style="stroke:#A80036;stroke-width:1.0;" x1="281.5" x2="281.5" y1="1533.9444" y2="1546.9444"/><line style="stroke:#A80036;stroke-width:1.0;" x1="240.5" x2="281.5" y1="1546.9444" y2="1546.9444"/><polygon fill="#A80036" points="250.5,1542.9444,240.5,1546.9444,250.5,1550.9444,246.5,1546.9444" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="246.5" y="1509.3764">startPlay()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="249.5" y="1528.2004">...</text><path d="M98,1506.2084 L98,1534.2084 L230,1534.2084 L230,1516.2084 L220,1506.2084 L98,1506.2084 " fill="#FBFB77" filter="url(#fqc15h4jettmy)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M220,1506.2084 L220,1516.2084 L230,1516.2084 L220,1506.2084 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="104" y="1526.2884">the same as above</text><!--MD5=[e65416592ffbdec3e5b01d28ce75eb4b]
@startuml

title SRS signaling UML
participant "one2one.html" as a order 1
participant "srs.sig.js" as b order 2
participant "srs.sdk.js" as c order 3
participant "httpx-static" as d order 4
participant "signaling" as e order 5
participant "srs" as f order 6

'connect and join
a -> a : btn_start.click(){startDemo}
a -> b : 1:connect(host,room,display)
b -> e : websocket.connect()
e - -> b : onopen
b - -> a : onopen
a -> b : 2:send("join")
b -> e : websocket.send()
e - -> b : participants
b - -> a : participants
note right : return room message \n include the ids of participants

'publish stream to srs
a -> a : startPublish()
a -> c : 3:publish(url)
c -> c : create local stream
c -> c : createOffer()
c -> c : setLocalDescription(offer)
c -> d : post publish/offer
note left : srs server separate from signaling`s\n use http to publish the \n stream to srs server
d ->o f : publish stream to srs
d - -> c : answer
note right : use lite-ice \n candidate is included in sdp
c -> c : setRemoteDescription()
c - -> a

'notify to signaling server
a -> b : 4:notify publish
note left : after publish stream to srs server \n refresh the signaling server \n tell about new strem published
b -[#green]> e : websocket.send("publish")
e - -> b : publish ok
b - -> a : publish ok

'play streams who published
a -> a : startPlay()
note left : play the streams connecting with \n participants returned in room
a -> c : 5:for(participants.id) -> play(url)
c -> c : createOffer()
c -> c : setLocalDescription(offer)
c -> d : post play/offer
d ->o f : play stream from srs
d - -> c : answer
c -> c : setRemoteDescription()
c - -> a : show

'when new guy publish play also
e - -[#green]> b : message: some publish stream
b - -> a : message: some publish stream
a -> a : startPlay() \n ...
note left : the same as above

@enduml

@startuml

title SRS signaling UML
participant "one2one.html" as a order 1
participant "srs.sig.js" as b order 2
participant "srs.sdk.js" as c order 3
participant "httpx-static" as d order 4
participant "signaling" as e order 5
participant "srs" as f order 6

a -> a : btn_start.click(){startDemo}
a -> b : 1:connect(host,room,display)
b -> e : websocket.connect()
e - -> b : onopen
b - -> a : onopen
a -> b : 2:send("join")
b -> e : websocket.send()
e - -> b : participants
b - -> a : participants
note right : return room message \n include the ids of participants

a -> a : startPublish()
a -> c : 3:publish(url)
c -> c : create local stream
c -> c : createOffer()
c -> c : setLocalDescription(offer)
c -> d : post publish/offer
note left : srs server separate from signaling`s\n use http to publish the \n stream to srs server
d ->o f : publish stream to srs
d - -> c : answer
note right : use lite-ice \n candidate is included in sdp
c -> c : setRemoteDescription()
c - -> a

a -> b : 4:notify publish
note left : after publish stream to srs server \n refresh the signaling server \n tell about new strem published
b -[#green]> e : websocket.send("publish")
e - -> b : publish ok
b - -> a : publish ok

a -> a : startPlay()
note left : play the streams connecting with \n participants returned in room
a -> c : 5:for(participants.id) -> play(url)
c -> c : createOffer()
c -> c : setLocalDescription(offer)
c -> d : post play/offer
d ->o f : play stream from srs
d - -> c : answer
c -> c : setRemoteDescription()
c - -> a : show

e - -[#green]> b : message: some publish stream
b - -> a : message: some publish stream
a -> a : startPlay() \n ...
note left : the same as above

@enduml

PlantUML version 1.2021.7(Sun May 23 20:40:07 CST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: zh
Country: HK
--></g></svg>